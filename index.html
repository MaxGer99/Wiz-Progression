<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wizard101 Progression Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: transparent;
            color: #ffffff;
            padding: 20px;
        }

        .container {
            max-width: 600px;
            background: rgba(0, 0, 0, 0.7);
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        .progress-section {
            margin-bottom: 20px;
        }

        .progress-label {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        .progress-bar-container {
            width: 100%;
            height: 30px;
            background: rgba(50, 50, 50, 0.8);
            border-radius: 15px;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.3);
            position: relative;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #4a90e2, #63b3ed);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.8);
            min-width: fit-content;
        }

        #worldProgress .progress-bar {
            background: linear-gradient(90deg, #9b59b6, #8e44ad);
        }

        #worldProgress .progress-bar.complete {
            background: linear-gradient(90deg, #2ecc71, #27ae60);
            animation: pulse 0.5s ease-in-out;
        }

        #totalProgress .progress-bar {
            background: linear-gradient(90deg, #f39c12, #e67e22);
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes celebrate {
            0% { transform: scale(1) rotate(0deg); }
            50% { transform: scale(1.1) rotate(5deg); }
            100% { transform: scale(1) rotate(0deg); }
        }

        .celebration {
            animation: celebrate 0.6s ease-in-out;
        }

        .current-quest {
            margin-bottom: 20px;
        }

        .current-quest-label {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            color: #63b3ed;
        }

        .current-quest-text {
            background: rgba(30, 30, 30, 0.8);
            padding: 12px 15px;
            border-radius: 8px;
            border-left: 4px solid #63b3ed;
            font-size: 15px;
            line-height: 1.4;
            min-height: 50px;
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
        }

        .current-quest-text:hover {
            background: rgba(40, 40, 40, 0.9);
            transform: scale(1.02);
        }

        .current-quest-text:active {
            transform: scale(0.98);
        }

        .counter-section {
            margin-top: 20px;
        }

        .counter-label {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            color: #f39c12;
        }

        .counter-display {
            background: rgba(30, 30, 30, 0.8);
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #f39c12;
            font-size: 28px;
            font-weight: bold;
            text-align: center;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            cursor: pointer;
            transition: background 0.2s, transform 0.1s;
        }

        .counter-display:hover {
            background: rgba(40, 40, 40, 0.9);
            transform: scale(1.05);
        }

        .counter-display:active {
            transform: scale(0.95);
        }

        .reset-button {
            margin-top: 15px;
            width: 100%;
            background: linear-gradient(90deg, #e74c3c, #c0392b);
        }

        .reset-button:hover {
            background: linear-gradient(90deg, #c0392b, #e74c3c);
        }

        .notification {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px 50px;
            border-radius: 15px;
            font-size: 32px;
            font-weight: bold;
            text-align: center;
            z-index: 9999;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            opacity: 0;
            transition: all 0.3s ease;
        }

        .notification.show {
            transform: translate(-50%, -50%) scale(1);
            opacity: 1;
        }

        .notification.world-complete {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .notification.game-complete {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        /* Control panel for easy updates */
        .control-panel {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid rgba(255, 255, 255, 0.2);
        }

        .control-panel h3 {
            margin-bottom: 15px;
            color: #63b3ed;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group label {
            display: block;
            margin-bottom: 5px;
            font-size: 13px;
            color: #bbb;
        }

        .control-group input,
        .control-group textarea {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(50, 50, 50, 0.8);
            color: #ffffff;
            font-family: inherit;
            font-size: 14px;
        }

        .control-group textarea {
            resize: vertical;
            min-height: 60px;
        }

        .control-group input[type="number"] {
            width: 100px;
        }

        button {
            background: linear-gradient(90deg, #4a90e2, #63b3ed);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            transition: transform 0.2s;
        }

        button:hover {
            transform: scale(1.05);
        }

        button:active {
            transform: scale(0.95);
        }

        .toggle-controls {
            margin-bottom: 15px;
        }

        .control-group select {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(50, 50, 50, 0.8);
            color: #ffffff;
            font-family: inherit;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- World Progress Bar -->
        <div class="progress-section" id="worldProgress">
            <div class="progress-label">
                <span id="worldLabel">World Progress</span>
                <span id="worldPercentage">0%</span>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar" id="worldBar" style="width: 0%;">
                    <span id="worldBarText"></span>
                </div>
            </div>
        </div>

        <!-- Total Progress Bar -->
        <div class="progress-section" id="totalProgress">
            <div class="progress-label">
                <span id="totalLabel">Total Progression</span>
                <span id="totalPercentage">0%</span>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar" id="totalBar" style="width: 0%;">
                    <span id="totalBarText"></span>
                </div>
            </div>
        </div>

        <!-- Current Quest -->
        <div class="current-quest">
            <div class="current-quest-label">Current Quest (click to advance):</div>
            <div style="display: flex; gap: 10px; align-items: stretch;">
                <button onclick="goBackQuest()" style="padding: 12px 15px; white-space: nowrap;">‚Üê Back</button>
                <div class="current-quest-text" id="currentQuest" onclick="advanceQuest()" style="flex: 1;">
                    Loading quest information...
                </div>
                <button onclick="advanceQuest()" style="padding: 12px 15px; white-space: nowrap;">Next ‚Üí</button>
            </div>
        </div>

        <!-- Counter -->
        <div class="counter-section">
            <div class="counter-label" id="counterLabel">Counter (click to increment):</div>
            <div class="counter-display" id="counterValue" onclick="incrementCounter()">0</div>
        </div>

        <!-- Notification overlay -->
        <div class="notification" id="notification"></div>

        <!-- Reset Button -->
        <button class="reset-button" id="resetButton" onclick="resetProgress()" style="display: none;">üîÑ Reset All Progress</button>

        <!-- Control Panel (hide this in OBS by adjusting the crop) -->
        <div class="control-panel">
            <button class="toggle-controls" onclick="toggleControls()">Show/Hide Settings</button>
            <button class="toggle-controls" onclick="toggleResetButton()" style="margin-left: 10px;">Show/Hide Reset</button>
            
            <div id="controls" style="display: none;">
                <h3>Update Overlay</h3>
                
                <div class="control-group">
                    <label for="worldSelect">Select World:</label>
                    <select id="worldSelect" onchange="onWorldChange()">
                        <option value="">-- Choose a World --</option>
                        <option value="Wizard City">Wizard City</option>
                        <option value="Krokotopia">Krokotopia</option>
                        <option value="Marleybone">Marleybone</option>
                        <option value="Mooshu">Mooshu</option>
                        <option value="Dragonspyre">Dragonspyre</option>
                        <option value="Celestia">Celestia</option>
                        <option value="Zafaria">Zafaria</option>
                        <option value="Avalon">Avalon</option>
                        <option value="Azteca">Azteca</option>
                        <option value="Khrysalis">Khrysalis</option>
                        <option value="Polaris">Polaris</option>
                        <option value="Mirage">Mirage</option>
                        <option value="Empyrea">Empyrea</option>
                        <option value="Karamelle">Karamelle</option>
                        <option value="Lemuria">Lemuria</option>
                        <option value="Novus">Novus</option>
                        <option value="Wallaru">Wallaru</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="worldCurrent">World Progress (current):</label>
                    <input type="number" id="worldCurrent" min="0" value="0">
                </div>

                <div class="control-group">
                    <label for="worldTotal">World Progress (total):</label>
                    <input type="number" id="worldTotal" min="1" value="100">
                </div>



                <div class="control-group">
                    <label for="questSelect">Current Quest:</label>
                    <select id="questSelect" onchange="onQuestChange()">
                        <option value="">-- Select Current Quest --</option>
                    </select>
                </div>
                
                <div class="control-group">
                    <label for="questText">Or Enter Custom Quest Name:</label>
                    <textarea id="questText" placeholder="Enter the current quest name...">Unicorn Way</textarea>
                </div>

                <div class="control-group">
                    <label for="counterText">Counter Label:</label>
                    <input type="text" id="counterText" placeholder="e.g., Deaths, Battles" value="Re-Rolls">
                </div>

                <div class="control-group">
                    <label for="counterNum">Counter Value:</label>
                    <input type="number" id="counterNum" min="0" value="0">
                </div>

                <button onclick="updateOverlay()">Update Display</button>
            </div>
        </div>
    </div>

    <script>
        let questDatabase = {};
        let worlds = {};

        // World order for progression
        const worldOrder = [
            'Wizard City',
            'Krokotopia',
            'Marleybone',
            'Mooshu',
            'Dragonspyre',
            'Celestia',
            'Zafaria',
            'Avalon',
            'Azteca',
            'Khrysalis',
            'Polaris',
            'Mirage',
            'Empyrea',
            'Karamelle',
            'Lemuria',
            'Novus',
            'Wallaru'
        ];

        // Compute per-world totals from questDatabase
        function computeWorldTotals() {
            const totals = {};
            Object.entries(questDatabase).forEach(([world, quests]) => {
                totals[world] = Array.isArray(quests) ? quests.length : 0;
            });
            return totals;
        }

        // Load quest data from JSON file
        async function loadQuestData() {
            try {
                const response = await fetch('quests.json');
                const data = await response.json();
                questDatabase = data.questDatabase || {};
                // Derive totals from questDatabase to avoid manual maintenance
                worlds = computeWorldTotals();
            } catch (error) {
                console.error('Error loading quest data:', error);
                // Fallback to default data if JSON fails to load
                initializeDefaultData();
            }
        }

        function initializeDefaultData() {
            questDatabase = {
                'Wizard City': ['Unicorn Way', 'Ghost Hunters', 'Skeleton Crew'],
                'Krokotopia': ['Welcome to Krok', 'Finding Sophia']
            };
            worlds = {
                'Wizard City': 39,
                'Krokotopia': 65
            };
        }

        function onWorldChange() {
            const world = document.getElementById('worldSelect').value;
            if (world) {
                const total = questDatabase[world] ? questDatabase[world].length : (worlds[world] || 0);
                document.getElementById('worldTotal').value = total;
                // Populate quest dropdown
                populateQuestDropdown(world);
            }
        }

        function populateQuestDropdown(world) {
            const questSelect = document.getElementById('questSelect');
            questSelect.innerHTML = '<option value="">-- Select Current Quest --</option>';
            
            if (questDatabase[world]) {
                questDatabase[world].forEach((quest, index) => {
                    const option = document.createElement('option');
                    const questName = typeof quest === 'string' ? quest : quest.name;
                    const questType = typeof quest === 'string' ? '' : (quest.type ? ` [${quest.type}]` : '');
                    option.value = questName;
                    option.textContent = `${index + 1}. ${questName}${questType}`;
                    questSelect.appendChild(option);
                });
            }
        }

        function onQuestChange() {
            const world = document.getElementById('worldSelect').value;
            const questSelect = document.getElementById('questSelect');
            const selectedQuest = questSelect.value;
            
            if (world && selectedQuest && questDatabase[world]) {
                const questIndex = questDatabase[world].findIndex(q => {
                    const qName = typeof q === 'string' ? q : q.name;
                    return qName === selectedQuest;
                });
                if (questIndex !== -1) {
                    // Set world progress to current quest position
                    document.getElementById('worldCurrent').value = questIndex;
                    document.getElementById('questText').value = selectedQuest;
                    updateOverlay();
                }
            }
        }

        function advanceQuest() {
            const world = document.getElementById('worldSelect').value;
            if (!world) {
                console.log('No world selected');
                return;
            }
            if (!questDatabase[world]) {
                console.log('Quest database not loaded for world:', world);
                return;
            }

            const currentQuestText = document.getElementById('questText').value;
            const currentIndex = questDatabase[world].findIndex(q => {
                const qName = typeof q === 'string' ? q : q.name;
                return qName === currentQuestText;
            });

            console.log('Current quest:', currentQuestText, 'Index:', currentIndex, 'Total quests:', questDatabase[world].length);

            // If we found the current quest and there's a next one in this world, advance
            if (currentIndex !== -1 && currentIndex < questDatabase[world].length - 1) {
                const nextQuest = questDatabase[world][currentIndex + 1];
                const nextQuestName = typeof nextQuest === 'string' ? nextQuest : nextQuest.name;
                
                console.log('Advancing to next quest:', nextQuestName);
                
                document.getElementById('worldCurrent').value = currentIndex + 1;
                document.getElementById('questText').value = nextQuestName;
                document.getElementById('questSelect').value = nextQuestName;
                updateOverlay();
            } else if (currentIndex === questDatabase[world].length - 1) {
                // At the end of the world, move to next world
                console.log('At end of world, moving to next world');
                moveToNextWorld();
            } else {
                console.log('Cannot advance - quest not found');
            }
        }

        function showNotification(message, type = 'default', duration = 3000) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = 'notification show';
            
            if (type === 'world-complete') {
                notification.classList.add('world-complete');
            } else if (type === 'game-complete') {
                notification.classList.add('game-complete');
            }
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, duration);
        }

        function moveToNextWorld() {
            const currentWorld = document.getElementById('worldSelect').value;
            const currentWorldIndex = worldOrder.indexOf(currentWorld);
            
            if (currentWorldIndex !== -1 && currentWorldIndex < worldOrder.length - 1) {
                const nextWorld = worldOrder[currentWorldIndex + 1];
                
                // Check if next world exists in database
                if (questDatabase[nextWorld] && questDatabase[nextWorld].length > 0) {
                    console.log('Moving to next world:', nextWorld);
                    
                    // Show notification
                    showNotification('üéâ ' + currentWorld + ' Complete!\nMoving to ' + nextWorld, 'world-complete', 4000);
                    
                    // Update world selection after a short delay
                    setTimeout(() => {
                        document.getElementById('worldSelect').value = nextWorld;
                        onWorldChange();
                        
                        // Set to first quest of new world
                        const firstQuest = questDatabase[nextWorld][0];
                        const firstQuestName = typeof firstQuest === 'string' ? firstQuest : firstQuest.name;
                        
                        document.getElementById('worldCurrent').value = 0;
                        document.getElementById('questText').value = firstQuestName;
                        document.getElementById('questSelect').value = firstQuestName;
                        
                        updateOverlay();
                    }, 1500);
                } else {
                    console.log('Next world not available in database');
                    showNotification('üéâ ' + currentWorld + ' Complete!\nAdd next world quests to continue', 'world-complete', 4000);
                }
            } else {
                console.log('At the last world!');
                showNotification('üéâ Congratulations!\nYou\'ve completed the Spiral!', 'game-complete', 5000);
            }
        }

        function goBackQuest() {
            const world = document.getElementById('worldSelect').value;
            if (!world) {
                console.log('No world selected');
                return;
            }
            if (!questDatabase[world]) {
                console.log('Quest database not loaded for world:', world);
                return;
            }

            const currentQuestText = document.getElementById('questText').value;
            const currentIndex = questDatabase[world].findIndex(q => {
                const qName = typeof q === 'string' ? q : q.name;
                return qName === currentQuestText;
            });

            console.log('Going back from quest:', currentQuestText, 'Index:', currentIndex);

            // If we found the current quest and there's a previous one, go back
            if (currentIndex > 0) {
                const prevQuest = questDatabase[world][currentIndex - 1];
                const prevQuestName = typeof prevQuest === 'string' ? prevQuest : prevQuest.name;
                
                console.log('Going back to previous quest:', prevQuestName);
                
                document.getElementById('worldCurrent').value = currentIndex - 1;
                document.getElementById('questText').value = prevQuestName;
                document.getElementById('questSelect').value = prevQuestName;
                updateOverlay();
            } else {
                console.log('Cannot go back - at beginning of quest list');
            }
        }

        // Load saved values from localStorage
        function loadSavedValues() {
            const saved = {
                worldName: localStorage.getItem('worldName') || 'Wizard City',
                worldCurrent: localStorage.getItem('worldCurrent') || '0',
                worldTotal: localStorage.getItem('worldTotal') || '39',
                questText: localStorage.getItem('questText') || 'Unicorn Way',
                counterText: localStorage.getItem('counterText') || 'Re-Rolls',
                counterNum: localStorage.getItem('counterNum') || '0'
            };

            // Set input values
            document.getElementById('worldSelect').value = saved.worldName;
            document.getElementById('worldCurrent').value = saved.worldCurrent;
            document.getElementById('worldTotal').value = saved.worldTotal;
            document.getElementById('questText').value = saved.questText;
            document.getElementById('counterText').value = saved.counterText;
            document.getElementById('counterNum').value = saved.counterNum;

            // Update display
            updateDisplay(saved);
        }

        function updateDisplay(data) {
            // Update world progress - increment by 1 to show completed quests
            const worldProgressValue = Math.min(data.worldTotal, data.worldCurrent + 1);
            const worldPercent = Math.min(100, Math.round((worldProgressValue / data.worldTotal) * 100));
            const questsLeft = Math.max(0, data.worldTotal - data.worldCurrent - 1);
            
            document.getElementById('worldLabel').textContent = data.worldName + ' Progress';
            document.getElementById('worldPercentage').textContent = worldPercent + '% (' + questsLeft + ' left)';
            document.getElementById('worldBar').style.width = worldPercent + '%';
            document.getElementById('worldBarText').textContent = worldProgressValue + '/' + data.worldTotal;

            // Celebrate when world is complete
            if (worldPercent === 100) {
                const worldBar = document.getElementById('worldBar');
                worldBar.classList.add('complete');
                celebrate();
                setTimeout(() => worldBar.classList.remove('complete'), 600);
            } else {
                document.getElementById('worldBar').classList.remove('complete');
            }

            // Update total progress based on all available quests (derived from questDatabase)
            const totalAvailableQuests = Object.values(worldOrder)
                .filter(w => questDatabase[w])
                .reduce((sum, w) => sum + questDatabase[w].length, 0);
            const totalCompletedQuests = calculateTotalCompletedQuests();
            const totalPercent = Math.min(100, Math.round((totalCompletedQuests / totalAvailableQuests) * 100));
            document.getElementById('totalPercentage').textContent = totalPercent + '%';
            document.getElementById('totalBar').style.width = totalPercent + '%';
            document.getElementById('totalBarText').textContent = totalCompletedQuests + '/' + totalAvailableQuests;

            // Update current quest with area and type
            let questDisplay = data.questText;
            const world = document.getElementById('worldSelect').value;
            if (world && questDatabase[world]) {
                const questObj = questDatabase[world].find(q => {
                    const qName = typeof q === 'string' ? q : q.name;
                    return qName === data.questText;
                });
                
                if (questObj && typeof questObj === 'object') {
                    let display = questObj.name;
                    if (questObj.area) {
                        display += '\n[' + questObj.area + ']';
                    }
                    if (questObj.type) {
                        display += '\n' + questObj.type;
                    }
                    questDisplay = display;
                }
            }
            document.getElementById('currentQuest').textContent = questDisplay;

            // Update counter
            document.getElementById('counterLabel').textContent = data.counterText + ':';
            document.getElementById('counterValue').textContent = data.counterNum;
        }

        function celebrate() {
            // Play celebration animation
            const container = document.querySelector('.container');
            container.classList.add('celebration');
            
            // Optional: Create confetti-like effect with multiple pulses
            const currentQuest = document.getElementById('currentQuest');
            currentQuest.classList.add('celebration');
            
            // Play a sound effect (if you want to add one later)
            // playSound('celebration.mp3');
        }

        function updateOverlay() {
            const data = {
                worldName: document.getElementById('worldSelect').value,
                worldCurrent: parseInt(document.getElementById('worldCurrent').value),
                worldTotal: parseInt(document.getElementById('worldTotal').value),
                questText: document.getElementById('questText').value,
                counterText: document.getElementById('counterText').value,
                counterNum: parseInt(document.getElementById('counterNum').value)
            };

            // Save to localStorage
            Object.keys(data).forEach(key => {
                localStorage.setItem(key, data[key]);
            });

            // Update display
            updateDisplay(data);
        }

        function calculateTotalCompletedQuests() {
            // Calculate total completed quests across all worlds
            let total = 0;
            
            // Add quests from all completed worlds before current world
            const currentWorld = document.getElementById('worldSelect').value;
            const currentWorldIndex = worldOrder.indexOf(currentWorld);
            
            for (let i = 0; i < currentWorldIndex; i++) {
                const world = worldOrder[i];
                if (questDatabase[world]) {
                    total += questDatabase[world].length;
                }
            }
            
            // Add current world progress
            const currentQuestIndex = parseInt(document.getElementById('worldCurrent').value);
            total += currentQuestIndex + 1; // +1 because index is 0-based but we want count
            
            return total;
        }

        function incrementCounter() {
            const counterInput = document.getElementById('counterNum');
            const currentValue = parseInt(counterInput.value) || 0;
            counterInput.value = currentValue + 1;
            updateOverlay();
        }

        function toggleControls() {
            const controls = document.getElementById('controls');
            controls.style.display = controls.style.display === 'none' ? 'block' : 'none';
        }

        function toggleResetButton() {
            const resetButton = document.getElementById('resetButton');
            resetButton.style.display = resetButton.style.display === 'none' ? 'block' : 'none';
        }

        function resetProgress() {
            if (confirm('Are you sure you want to reset all progress? This cannot be undone.')) {
                // Clear localStorage
                localStorage.clear();
                
                // Reset to defaults
                document.getElementById('worldSelect').value = 'Wizard City';
                document.getElementById('worldCurrent').value = 0;
                document.getElementById('worldTotal').value = 39;
                document.getElementById('questText').value = 'Unicorn Way';
                document.getElementById('counterText').value = 'Re-Rolls';
                document.getElementById('counterNum').value = 0;
                
                onWorldChange();
                updateOverlay();
                
                showNotification('Progress Reset!', 'default', 2000);
            }
        }

        // Keyboard shortcuts for quick counter updates
        document.addEventListener('keydown', function(e) {
            // Press + or = to increment counter
            if (e.key === '+' || e.key === '=') {
                const counterInput = document.getElementById('counterNum');
                counterInput.value = parseInt(counterInput.value) + 1;
                updateOverlay();
                e.preventDefault();
            }
            // Press - to decrement counter
            if (e.key === '-') {
                const counterInput = document.getElementById('counterNum');
                counterInput.value = Math.max(0, parseInt(counterInput.value) - 1);
                updateOverlay();
                e.preventDefault();
            }
        });

        // Load saved values on page load
        window.addEventListener('load', async function() {
            await loadQuestData();
            loadSavedValues();
        });
    </script>
</body>
</html>
